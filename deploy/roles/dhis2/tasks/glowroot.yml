- name: Creating /opt/glowroot directory
  ansible.builtin.file:
    path: /opt/glowroot
    owner: tomcat
    group: tomcat
    state: directory
    modification_time: preserve
    access_time: preserve
    mode: '0755'
  tags: [never]

- name: "Download and extract glowroot"
  ansible.builtin.unarchive:
    src: https://github.com/glowroot/glowroot/releases/download/v0.13.6/glowroot-0.13.6-dist.zip
    dest: /opt/
    group: tomcat
    owner: tomcat
    remote_src: true
    mode: '0755'

- name: "Copy glowroot configs to the instances"
  ansible.builtin.template:
    src: glowroot_admin.json
    dest: /opt/glowroot/admin.json
    group: tomcat
    owner: tomcat
    mode: '0640'
  changed_when: false
